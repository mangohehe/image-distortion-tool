IMAGE DISTORTION TOOL - PROJECT STRUCTURE
=========================================

image-distortion-tool/
│
├── Documentation
│   ├── README.md                    # Quick start guide
│   ├── DESIGN.md                    # Overall product vision  
│   ├── DESIGN_PHASE1.md            # Phase 1 detailed design
│   └── IMPLEMENTATION_SUMMARY.md    # Implementation overview
│
├── Docker Configuration
│   ├── Dockerfile                   # Container definition
│   ├── docker-compose.yml          # Compose configuration
│   └── .dockerignore               # Build exclusions
│
├── Python Dependencies
│   ├── requirements.txt            # Production dependencies
│   └── requirements-dev.txt        # Development dependencies
│
├── Application Code
│   ├── app.py                      # Main Streamlit entry point
│   │
│   └── src/
│       ├── __init__.py
│       │
│       ├── components/             # Core backend components
│       │   ├── __init__.py
│       │   ├── pipeline_manager.py      # Pipeline configuration management
│       │   ├── batch_processor.py       # Batch image processing engine
│       │   ├── mask_handler.py          # Image-mask synchronization
│       │   └── transform_registry.py    # Transform catalog & metadata
│       │
│       └── pages/                  # UI pages
│           ├── __init__.py
│           ├── config_page.py           # Configuration & processing UI
│           └── review_page.py           # Grid review & comparison UI
│
├── Setup Scripts
│   └── setup_workspace.sh          # Initialize workspace directories
│
├── Version Control
│   └── .gitignore                  # Git exclusions
│
└── Workspace (User Data - Docker Volume Mount)
    ├── input/
    │   ├── images/                 # User's source images
    │   └── masks/                  # Optional masks
    │
    ├── pipelines/                  # Saved pipeline configurations
    │   └── default.json           # Default pipeline example
    │
    ├── output/                     # Generated results
    │   └── run_YYYYMMDD_HHMMSS/   # Timestamped run directory
    │       ├── manifest.json       # Processing metadata
    │       ├── pipeline.json       # Pipeline used
    │       └── distortion_XXX/     # Variant directories
    │           ├── images/         # Distorted images
    │           └── masks/          # Distorted masks
    │
    └── logs/                       # Execution logs
        └── run_YYYYMMDD_HHMMSS.log


KEY FILES DESCRIPTION
====================

Backend Components:
-------------------
pipeline_manager.py      - Manages pipeline configurations (load/save/validate)
                         - Supports custom JSON and Albumentations native formats
                         - Exports to Python code
                         - Classifies transforms (geometric vs pixel)

batch_processor.py       - Executes pipelines on image directories
                         - Generates multiple variants per image
                         - Creates timestamped run directories
                         - Logs execution and generates manifests

mask_handler.py          - Pairs images with masks (3 strategies)
                         - Validates dimensions
                         - Synchronizes geometric transforms
                         - Creates visualization overlays

transform_registry.py    - Catalogs 35+ Albumentations transforms
                         - Provides metadata and parameter schemas
                         - Supports search and filtering

UI Pages:
---------
config_page.py          - Configuration interface
                        - Transform selection and parameter adjustment
                        - Live preview with mask overlay
                        - Batch processing trigger
                        - Pipeline export

review_page.py          - Results review interface
                        - Run selection and browsing
                        - Grid view (original + variants)
                        - Mask overlay toggle
                        - Detailed view with navigation


DATA FLOW
=========

1. User adds images → workspace/input/images/
2. Optional: User adds masks → workspace/input/masks/
3. User opens web UI (http://localhost:8501)
4. User configures pipeline in Configuration Page
5. User clicks "Process All Images"
6. Batch Processor:
   - Scans input directory
   - Pairs images with masks
   - Creates timestamped run directory
   - For each image:
     * Generates N variants
     * Applies geometric transforms to both image and mask
     * Applies pixel transforms to image only
     * Saves to distortion_XXX/ subdirectories
   - Saves manifest.json with results
7. User opens Grid Review Page
8. User browses results, toggles mask overlay
9. User exports pipeline JSON for reuse


DEPLOYMENT
==========

Local Development:
  python -m venv venv
  source venv/bin/activate
  pip install -r requirements.txt
  streamlit run app.py

Docker Production:
  docker-compose up
  # Access at http://localhost:8501


TECHNOLOGIES
============

Backend:
  - Python 3.10+
  - Albumentations 1.3.1 (image augmentation)
  - OpenCV 4.8 (image I/O)
  - NumPy 1.24 (array operations)

Frontend:
  - Streamlit 1.28 (web UI framework)

Infrastructure:
  - Docker (containerization)
  - Docker Compose (orchestration)

Storage:
  - Filesystem (no database required)
